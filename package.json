{
  "name": "fpv-drone-chat",
  "version": "1.0.0",
  "description": "Чат-бот для технічної підтримки FPV дронів, що використовує PDF-мануалів, оптимізований для ЗСУ та волонтерів",
  "main": "server.js",
  "scripts": {
    "start": "node server.js",
    "dev": "nodemon server.js"
  },
  "engines": {
    "node": "20.x"
  },
  "dependencies": {
    "@google/generative-ai": "^0.24.1",
    "express": "^4.18.2",
    "pdf-parse": "^1.1.1"
  },
  "devDependencies": {
    "nodemon": "^3.0.1"
  },
  "author": "DroneSupport Team",
  "license": "MIT",
  "repository": {
    "type": "git",
    "url": "https://github.com/твій_репо/fpv-drone-chat.git"
  },
  "keywords": [
    "fpv",
    "drone",
    "technical-support",
    "chatbot",
    "gemini",
    "zsu"
  ]
}
const NodeCache = require('node-cache');
const cache = new NodeCache({ stdTTL: 600 }); // Кеш на 10 хвилин

async function extractFromPDF(filePath, searchTerms) {
  const cacheKey = `${filePath}-${searchTerms.join('-')}`;
  const cached = cache.get(cacheKey);
  if (cached) return cached;

  console.log('Обробка PDF:', filePath, 'з термінами:', searchTerms);
  try {
    const dataBuffer = fs.readFileSync(filePath);
    const data = await pdf(dataBuffer);
    const text = data.text.toLowerCase();
    const result = searchTerms.some(term => text.includes(term)) ? text.substring(0, 500) + '...' : 'Інформація відсутня в мануалах.';
    cache.set(cacheKey, result);
    return result;
  } catch (err) {
    console.error(`Помилка обробки PDF ${filePath}:`, err.message);
    return 'Помилка обробки PDF.';
  }
}